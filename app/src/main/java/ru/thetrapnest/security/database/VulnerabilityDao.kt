package ru.thetrapnest.security.database

import androidx.room.Dao
import androidx.room.Query
import androidx.room.Insert
import androidx.room.OnConflictStrategy
import kotlinx.coroutines.flow.Flow

@Dao
interface VulnerabilityDao {
    @Query("SELECT * FROM vulnerabilities")
    fun getAllVulnerabilities(): Flow<List<VulnerabilityEntity>>

    @Query("SELECT * FROM vulnerabilities WHERE id = :id")
    fun getVulnerabilityById(id: Int): Flow<VulnerabilityEntity?>

    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertVulnerability(vulnerability: VulnerabilityEntity)

    @Insert(onConflict = OnConflictStrategy.REPLACE)
    suspend fun insertVulnerabilities(vulnerabilities: List<VulnerabilityEntity>)

    @Query("SELECT COUNT(*) FROM vulnerabilities")
    suspend fun getVulnerabilitiesCount(): Int
}